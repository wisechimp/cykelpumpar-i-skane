{"version":3,"file":"component---src-pages-index-tsx-51fca09ccb27058c3649.js","mappings":"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","sources":["webpack://cykelpumpar-i-skane/./src/components/DisplayBanner/DisplayBanner.tsx","webpack://cykelpumpar-i-skane/./src/components/DisplayBanner/displaybanner.module.css","webpack://cykelpumpar-i-skane/./src/components/Menu/Menu.tsx","webpack://cykelpumpar-i-skane/./src/components/Layout/Layout.tsx","webpack://cykelpumpar-i-skane/./src/components/LinkButton/LinkButton.tsx","webpack://cykelpumpar-i-skane/./src/components/LinkButton/linkbutton.module.css","webpack://cykelpumpar-i-skane/./src/settings/mapbox-settings.ts","webpack://cykelpumpar-i-skane/./src/components/MapPopup/MapPopup.tsx","webpack://cykelpumpar-i-skane/./src/components/CyclePumpMap/CyclePumpMap.tsx","webpack://cykelpumpar-i-skane/./src/pages/index.tsx"],"sourcesContent":["import React from 'react'\nimport { Link } from 'gatsby'\n\nimport * as styles from './displaybanner.module.css'\n\nconst DisplayBanner = () => (\n  <div className={styles.banner}>\n    <Link to=\"/contact\">Your Message Here!</Link>\n  </div>\n)\n\nexport default DisplayBanner","// extracted by mini-css-extract-plugin\nexport var banner = \"displaybanner-module--banner--kiZu9\";","import React from 'react'\n\nconst Menu = () => (\n  <div>\n    <p>So this is the Menu. Good luck getting anywhere with it eh!</p>\n  </div>\n)\n\nexport default Menu","import React, { ReactNode } from 'react'\n\nimport DisplayBanner from 'components/DisplayBanner/DisplayBanner'\nimport Menu from 'components/Menu/Menu'\n\ninterface LayoutProps {\n  pageTitle: string\n  children: ReactNode\n  bannerVisibility: boolean\n}\n\nconst Layout = ({pageTitle, children, bannerVisibility}: LayoutProps) => (\n  <div>\n    <Menu />\n    <h1>{pageTitle}</h1>\n    {children}\n    {bannerVisibility && \n      <div className='display-banner'><DisplayBanner /></div>\n    }\n  </div>\n)\n\nexport default Layout","import { Link } from 'gatsby'\nimport React from 'react'\n\nimport * as styles from './linkbutton.module.css'\n\ninterface LinkButtonProps {\n  target: string,\n  text: string\n}\n\nconst LinkButton = ({ target, text }: LinkButtonProps) => (\n  <div className={styles.button}>\n    <Link to={target}>{text}</Link>\n  </div>\n)\n\nexport default LinkButton","// extracted by mini-css-extract-plugin\nexport var button = \"linkbutton-module--button--PQy2M\";","const mapboxSettings = {\n  lng: 13.192234,\n  lat: 55.704249,\n  zoom: 12\n}\n\nexport default mapboxSettings","import React from 'react'\n\nimport LinkButton from 'components/LinkButton/LinkButton'\n\ninterface MapPopupProps {\n  name: string,\n  address: string,\n  reference?: string\n}\n\nconst MapPopup = ({ name, address, reference }: MapPopupProps) => (\n  <div>\n    <h3>{name}</h3>\n    <p>{address}</p>\n    <LinkButton target={`/cyclepumps/${reference}`} text='See Pump' />\n  </div>\n)\n\nexport default MapPopup","import React, { useEffect, useRef } from 'react'\n// @ts-ignore\nimport { Map, AttributionControl, EventData, GeolocateControl, Marker, Popup } from '!mapbox-gl'\n\nimport mapboxSettings from '../../settings/mapbox-settings'\nimport MapPopup from 'components/MapPopup/MapPopup'\nimport ReactDOM from 'react-dom'\n\nconst CyclePumpMap = () => {\n  interface CyclePumpData {\n    id: number,\n    properties: {\n      name: string,\n      address: string,\n      reference?: string\n    }\n  }\n\n  interface EventCoordinates {\n    x: number,\n    y: number\n  }\n\n  const accessToken = process.env.MAPBOX_ACCESS_TOKEN\n\n  const mapNode = useRef(null)\n  const cyclePumpPopupRef = useRef(new Popup({ offset: [0, -15] }))\n\n  useEffect(() => {\n    if (!mapNode.current) return\n\n    const map = new Map({\n      accessToken,\n      attributionControl: false,\n      container: mapNode.current,\n      style: \"mapbox://styles/wisechimp/ck7bzyusk00uq1iqu32awttdx\",\n      center: [mapboxSettings.lng, mapboxSettings.lat],\n      zoom: mapboxSettings.zoom\n    })\n      .addControl(\n        new AttributionControl({\n          compact: true\n        })\n      )\n      .addControl(\n        new GeolocateControl({\n          positionOptions: {\n            enableHighAccuracy: true\n          },\n          trackUserLocation: true,\n          showUserHeading: true,\n          showUserLocation: true\n        })\n      )\n\n    const cyclePumpMarker = new Marker()\n\n    map.on('mouseenter', 'cykelpumpar-lund', () => {\n      map.getCanvas().style.cursor = 'pointer'\n    })\n\n    map.on('mouseleave', 'cykelpumpar-lund', () => {\n      map.getCanvas().style.cursor = ''\n    })\n\n    map.on(\"click\", (clickData: EventData)  => {\n      console.log(\"Power click!\")\n\n      const { point, lngLat } = clickData\n      const mapPopup = null\n      const mapPopupData = fetchPopupData(map, mapPopup, point)\n\n      if (mapPopupData) {\n        console.log(\"Clicked Pump's id: \" + mapPopupData[0].id)\n        renderPopup(mapPopupData[0], lngLat).addTo(map)\n        renderMarker(cyclePumpMarker, lngLat).addTo(map)\n      } else {\n        console.log(\"There's no pump there my friend\")\n        if (cyclePumpMarker) {\n          return cyclePumpMarker.remove()\n        }\n      }\n    })\n\n    return () => {\n      map.remove()\n    }\n  }, [])\n\n  const fetchPopupData = (map: Map, mapPopup: Popup, point: EventData.point) => {\n    if (mapPopup !== null) {\n      mapPopup.remove()\n    }\n\n    const mapFeatures = map.queryRenderedFeatures(point, {\n      layers: [\"cykelpumpar-lund\"]\n    })\n\n    if (!mapFeatures.length) {\n      return console.log(\"No Features\")\n    }\n    return mapFeatures\n  }\n\n  const renderMarker = (marker: Marker, latLng: EventData) => {\n    return marker.setLngLat(latLng)\n  }\n\n  const renderPopup = (data: CyclePumpData, lngLat: EventCoordinates) => {\n    console.log(data)\n    const { properties } = data\n    const { name, address, reference} = properties\n    const popupNode = document.createElement(\"div\")\n    ReactDOM.render(\n      <MapPopup name={name} address={address} reference={reference} />,\n      popupNode\n    )\n    return cyclePumpPopupRef.current\n      .setLngLat(lngLat)\n      .setDOMContent(popupNode)\n  }\n\n  return (\n    <div>\n      <div ref={mapNode} />\n    </div>\n  )\n\n}\n\nexport default CyclePumpMap\n\n","import React from \"react\"\n\nimport Layout from 'components/Layout/Layout'\nimport CyclePumpMap from 'components/CyclePumpMap/CyclePumpMap'\n\nconst HomePage = () => {\n  return (\n    <Layout pageTitle=\"Home sweet home!\" bannerVisibility>\n      <p>We'll probably have a map here. Goodness knows how I'll TS that in!</p>\n      <CyclePumpMap />\n    </Layout>\n  )}\n\nexport default HomePage\n"],"names":["className","Link","to","pageTitle","children","bannerVisibility","target","text","lng","lat","zoom","name","address","reference","LinkButton","mapNode","useRef","cyclePumpPopupRef","Popup","offset","useEffect","current","map","Map","accessToken","process","attributionControl","container","style","center","mapboxSettings","addControl","AttributionControl","compact","GeolocateControl","positionOptions","enableHighAccuracy","trackUserLocation","showUserHeading","showUserLocation","cyclePumpMarker","Marker","on","getCanvas","cursor","clickData","console","log","point","lngLat","mapPopupData","fetchPopupData","id","renderPopup","addTo","renderMarker","remove","mapPopup","mapFeatures","queryRenderedFeatures","layers","length","marker","latLng","setLngLat","data","properties","popupNode","document","createElement","ReactDOM","setDOMContent","ref","Layout"],"sourceRoot":""}