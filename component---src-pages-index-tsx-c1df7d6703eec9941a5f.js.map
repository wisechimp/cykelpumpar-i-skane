{"version":3,"file":"component---src-pages-index-tsx-c1df7d6703eec9941a5f.js","mappings":"uLAWA,EANe,kBACb,uBAAKA,UCLa,gCDMhB,gBAAC,EAAAC,KAAD,CAAMC,GAAG,YAAT,wBECJ,EANa,kBACX,2BACE,0FCkBJ,EAXe,SAAC,GAAD,IAAEC,EAAF,EAAEA,UAAWC,EAAb,EAAaA,SAAUC,EAAvB,EAAuBA,iBAAvB,OACb,2BACE,gBAAC,EAAD,MACA,0BAAKF,GACJC,EACAC,GACC,uBAAKL,UAAU,aAAY,gBAAC,EAAD,U,oGCXjC,EANuB,CACrBM,IAAK,UACLC,IAAK,UACLC,KAAM,ICOR,EANiB,kBACf,uBAAKR,UCJe,oCDKlB,qD,UE6GJ,EA1GqB,WAcnB,IAAMS,EAAcC,+FAEdC,GAAUC,EAAAA,EAAAA,QAAO,MACjBC,GAAoBD,EAAAA,EAAAA,QAAO,IAAIE,EAAAA,MAAM,CAAEC,OAAQ,CAAC,GAAI,QAE1DC,EAAAA,EAAAA,YAAU,WAER,GADAC,QAAQC,IAAIT,GACPE,EAAQQ,QAAb,CAEA,IAAMC,EAAM,IAAIC,EAAAA,IAAI,CAClBZ,YAAAA,EACAa,UAAWX,EAAQQ,QACnBI,MAAO,sDACPC,OAAQ,CAACC,EAAAA,IAAoBA,EAAAA,KAC7BjB,KAAMiB,EAAAA,OAELC,WACC,IAAIC,EAAAA,iBAAiB,CACnBC,gBAAiB,CACfC,oBAAoB,GAEtBC,mBAAmB,EACnBC,iBAAiB,EACjBC,kBAAkB,KA4BxB,OAxBAZ,EAAIa,GAAG,aAAc,oBAAoB,WACvCb,EAAIc,YAAYX,MAAMY,OAAS,aAGjCf,EAAIa,GAAG,aAAc,oBAAoB,WACvCb,EAAIc,YAAYX,MAAMY,OAAS,MAGjCf,EAAIa,GAAG,SAAS,SAACG,GACfnB,QAAQC,IAAI,gBACZ,IAAQmB,EAAkBD,EAAlBC,MAAOC,EAAWF,EAAXE,OAITC,EAAgBC,EAAgBpB,EAFpB,KAEoCiB,GAElDE,GACFtB,QAAQC,IAAI,sBAAwBqB,EAAc,GAAGE,IACrDC,EAAYH,EAAc,GAAID,GAAQK,MAAMvB,IAE5CH,QAAQC,IAAI,sCAIT,WACLE,EAAIwB,aAEL,IAEH,IAAMJ,EAAkB,SAACpB,EAAUyB,EAAmBR,GAClC,OAAdQ,GACFA,EAAUD,SAGZ,IAAME,EAAc1B,EAAI2B,sBAAsBV,EAAO,CACnDW,OAAQ,CAAC,sBAGX,OAAKF,EAAYG,OAGVH,EAFE7B,QAAQC,IAAI,gBAKjBwB,EAAa,SAACQ,EAAqBZ,GACvC,IAAQa,EAAeD,EAAfC,WAEFC,GADmBD,EAAjBE,KAAiBF,EAAXG,QACIC,SAASC,cAAc,QAKzC,OAJAC,EAAAA,OACE,gBAAC,EAAD,MACAL,GAEKvC,EAAkBM,QACtBuC,UAAUpB,GACVqB,cAAcP,IAGnB,OACE,2BACE,uBAAKQ,IAAKjD,MChGhB,EARiB,WACf,OACE,gBAACkD,EAAA,EAAD,CAAQ1D,UAAU,mBAAmBE,kBAAgB,GACnD,gGACA,gBAAC,EAAD","sources":["webpack://cykelpumpar-i-skane/./src/components/Advert/Advert.tsx","webpack://cykelpumpar-i-skane/./src/components/Advert/advert.module.css","webpack://cykelpumpar-i-skane/./src/components/Menu/Menu.tsx","webpack://cykelpumpar-i-skane/./src/components/Layout/Layout.tsx","webpack://cykelpumpar-i-skane/./src/settings/mapbox-settings.ts","webpack://cykelpumpar-i-skane/./src/components/MapPopup/MapPopup.tsx","webpack://cykelpumpar-i-skane/./src/components/MapPopup/mappopup.module.css","webpack://cykelpumpar-i-skane/./src/components/CyclePumpMap/CyclePumpMap.tsx","webpack://cykelpumpar-i-skane/./src/pages/index.tsx"],"sourcesContent":["import React from 'react'\nimport { Link } from 'gatsby'\n\nimport * as styles from './advert.module.css'\n\nconst Advert = () => (\n  <div className={styles.banner}>\n    <Link to=\"/contact\">Your Message Here!</Link>\n  </div>\n)\n\nexport default Advert","// extracted by mini-css-extract-plugin\nexport var banner = \"advert-module--banner--kbtab\";","import React from 'react'\n\nconst Menu = () => (\n  <div>\n    <p>So this is the Menu. Good luck getting anywhere with it eh!</p>\n  </div>\n)\n\nexport default Menu","import React, { ReactNode } from 'react'\n\nimport Advert from 'components/Advert/Advert'\nimport Menu from 'components/Menu/Menu'\n\ninterface LayoutProps {\n  pageTitle: string\n  children: ReactNode\n  advertVisibility: boolean\n}\n\nconst Layout = ({pageTitle, children, advertVisibility}: LayoutProps) => (\n  <div>\n    <Menu />\n    <h1>{pageTitle}</h1>\n    {children}\n    {advertVisibility && \n      <div className=\"banner-ad\"><Advert /></div>\n    }\n  </div>\n)\n\nexport default Layout","const mapboxSettings = {\n  lng: 13.192234,\n  lat: 55.704249,\n  zoom: 12\n}\n\nexport default mapboxSettings","import React from 'react'\n\nimport * as styles from './mappopup.module.css'\n\nconst MapPopup = () => (\n  <div className={styles.mapPopup}>\n    <p>What's popped up here?</p>\n  </div>\n)\n\nexport default MapPopup","// extracted by mini-css-extract-plugin\nexport var mapPopup = \"mappopup-module--mapPopup--kHkwD\";","import React, { useEffect, useRef, MouseEvent } from 'react'\n// @ts-ignore\nimport { Map, EventData, GeolocateControl, Marker, Popup } from '!mapbox-gl'\n\nimport mapboxSettings from '../../settings/mapbox-settings'\nimport MapPopup from 'components/MapPopup/MapPopup'\nimport ReactDOM from 'react-dom'\nimport { stringify } from 'querystring'\n\nconst CyclePumpMap = () => {\n  interface CyclePumpData {\n    id: number,\n    properties: {\n      name: string,\n      address: string\n    }\n  }\n\n  interface EventCoordinates {\n    x: number,\n    y: number\n  }\n\n  const accessToken = process.env.MAPBOX_ACCESS_TOKEN\n\n  const mapNode = useRef(null)\n  const cyclePumpPopupRef = useRef(new Popup({ offset: [0, -15] }))\n\n  useEffect(() => {\n    console.log(accessToken)\n    if (!mapNode.current) return\n\n    const map = new Map({\n      accessToken,\n      container: mapNode.current,\n      style: \"mapbox://styles/wisechimp/ck7bzyusk00uq1iqu32awttdx\",\n      center: [mapboxSettings.lng, mapboxSettings.lat],\n      zoom: mapboxSettings.zoom\n    })\n      .addControl(\n        new GeolocateControl({\n          positionOptions: {\n            enableHighAccuracy: true\n          },\n          trackUserLocation: true,\n          showUserHeading: true,\n          showUserLocation: true\n        })\n      )\n\n    map.on('mouseenter', 'cykelpumpar-lund', () => {\n      map.getCanvas().style.cursor = 'pointer'\n    })\n\n    map.on('mouseleave', 'cykelpumpar-lund', () => {\n      map.getCanvas().style.cursor = ''\n    })\n\n    map.on(\"click\", (clickData: EventData)  => {\n      console.log(\"Power click!\")\n      const { point, lngLat } = clickData\n\n      const mapMarker = null\n\n      const mapMarkerData = fetchMarkerData(map, mapMarker, point)\n\n      if (mapMarkerData) {\n        console.log(\"Clicked Pump's id: \" + mapMarkerData[0].id)\n        renderPopup(mapMarkerData[0], lngLat).addTo(map)\n      } else {\n        console.log(\"There's no pump there my friend\")\n      }\n    })\n\n    return () => {\n      map.remove()\n    }\n  }, [])\n\n  const fetchMarkerData = (map: Map, mapMarker: Marker, point: EventData.point) => {\n    if (mapMarker !== null) {\n      mapMarker.remove()\n    }\n\n    const mapFeatures = map.queryRenderedFeatures(point, {\n      layers: [\"cykelpumpar-lund\"]\n    })\n\n    if (!mapFeatures.length) {\n      return console.log(\"No Features\")\n    }\n    return mapFeatures\n  }\n\n  const renderPopup= (data: CyclePumpData, lngLat: EventCoordinates) => {\n    const { properties } = data\n    const { name, address} = properties\n    const popupNode = document.createElement(\"div\")\n    ReactDOM.render(\n      <MapPopup />,\n      popupNode\n    )\n    return cyclePumpPopupRef.current\n      .setLngLat(lngLat)\n      .setDOMContent(popupNode)\n  }\n\n  return (\n    <div>\n      <div ref={mapNode} />\n    </div>\n  )\n\n}\n\nexport default CyclePumpMap\n","import React from \"react\"\n\nimport Layout from 'components/Layout/Layout'\nimport CyclePumpMap from 'components/CyclePumpMap/CyclePumpMap'\n\nconst HomePage = () => {\n  return (\n    <Layout pageTitle=\"Home sweet home!\" advertVisibility>\n      <p>We'll probably have a map here. Goodness knows how I'll TS that in!</p>\n      <CyclePumpMap />\n    </Layout>\n  )}\n\nexport default HomePage\n"],"names":["className","Link","to","pageTitle","children","advertVisibility","lng","lat","zoom","accessToken","process","mapNode","useRef","cyclePumpPopupRef","Popup","offset","useEffect","console","log","current","map","Map","container","style","center","mapboxSettings","addControl","GeolocateControl","positionOptions","enableHighAccuracy","trackUserLocation","showUserHeading","showUserLocation","on","getCanvas","cursor","clickData","point","lngLat","mapMarkerData","fetchMarkerData","id","renderPopup","addTo","remove","mapMarker","mapFeatures","queryRenderedFeatures","layers","length","data","properties","popupNode","name","address","document","createElement","ReactDOM","setLngLat","setDOMContent","ref","Layout"],"sourceRoot":""}